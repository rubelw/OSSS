# OSSS Database Migrations

This directory contains the **database migrations** for the OSSS project, managed using [Alembic](https://alembic.sqlalchemy.org/). Alembic is a lightweight database migration tool for usage with SQLAlchemy, which OSSS uses as its ORM (Object Relational Mapper).

## What are Database Migrations?

Database migrations are a way of evolving your database schema safely over time. Instead of making manual changes to the database, you:

1. Define or update your SQLAlchemy models in the OSSS codebase.
2. Generate a migration script that reflects those changes.
3. Apply the migration to update your database schema.

This process ensures that your database structure stays in sync with your application code, even as features evolve.

## Directory Structure

The `migrations` folder typically looks like this:

```
migrations/
├── env.py
├── README
├── script.py.mako
└── versions/
    ├── <revision_id>_<description>.py
    └── ...
```

### Key Files

- **`env.py`**  
  The main Alembic environment configuration file. It sets up the connection to the database and tells Alembic how to run migrations.

- **`script.py.mako`**  
  A template file used when Alembic generates new migration scripts.

- **`versions/`**  
  This folder contains individual migration scripts. Each file represents a single change to the database schema, such as creating a new table or modifying an existing one. The file name usually starts with a revision ID and a short description of the change.

## Common Commands

Here are some typical Alembic commands you might use when working with migrations in OSSS:

- **Create a new migration (autogenerate):**
  ```bash
  alembic revision --autogenerate -m "short description of change"
  ```

- **Apply migrations (upgrade):**
  ```bash
  alembic upgrade head
  ```

- **Rollback migrations (downgrade):**
  ```bash
  alembic downgrade -1
  ```

- **Show current migration state:**
  ```bash
  alembic current
  ```

- **View migration history:**
  ```bash
  alembic history
  ```

## How OSSS Uses Migrations

In OSSS, migrations are critical to ensure that the database schema matches the domain models defined in the code. When new features are added (like new tables for goals, plans, or personal notes), a migration script is created to modify the schema accordingly. This allows different developers and environments (development, staging, production) to stay in sync.

## Best Practices

- Always review autogenerated migrations before applying them.
- Keep migrations committed to version control so they can be shared with your team.
- Run migrations as part of your deployment process to ensure your database is always up to date.

---

For more details on Alembic, see the [Alembic Documentation](https://alembic.sqlalchemy.org/en/latest/).

